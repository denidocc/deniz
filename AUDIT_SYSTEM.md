# üìã –°–∏—Å—Ç–µ–º–∞ –∞—É–¥–∏—Ç–∞ DENIZ Restaurant

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∞—É–¥–∏—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –≤–∞–∂–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ DENIZ, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –ø–æ–ª–Ω—É—é –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏.

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–í—Å–µ HTTP –∑–∞–ø—Ä–æ—Å—ã** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ AuditMiddleware
- **–î–µ–π—Å—Ç–≤–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∞** - –≤—Ö–æ–¥/–≤—ã—Ö–æ–¥, —Ä–∞–±–æ—Ç–∞ —Å –∑–∞–∫–∞–∑–∞–º–∏, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–∞–º–∏
- **–°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è** - –æ—à–∏–±–∫–∏, –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
- **–ü–µ—á–∞—Ç—å —á–µ–∫–æ–≤** - –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–µ—á–∞—Ç–∏ –Ω–∞ –∫—É—Ö–Ω—é, –±–∞—Ä, –∫–ª–∏–µ–Ω—Ç–∞–º

### 2. –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- **–ö—Ç–æ** - ID —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, –∏–º—è, —Ä–æ–ª—å
- **–ß—Ç–æ** - —Ç–∏–ø –¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—è–º–∏
- **–ö–æ–≥–¥–∞** - —Ç–æ—á–Ω–∞—è –≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞
- **–ì–¥–µ** - IP –∞–¥—Ä–µ—Å, user agent, URL
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç** - ID —Å—Ç–æ–ª–∞, –∑–∞–∫–∞–∑–∞, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### 3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** - –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã
- **–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å** - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤

## üõ†Ô∏è –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `audit_log`

```sql
id                  - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞–ø–∏—Å–∏
staff_id           - ID —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å NULL –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π)
action             - –¢–∏–ø –¥–µ–π—Å—Ç–≤–∏—è (user_login, order_create, etc.)
table_affected     - ID –∑–∞—Ç—Ä–æ–Ω—É—Ç–æ–≥–æ —Å—Ç–æ–ª–∞ (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)
order_affected     - ID –∑–∞—Ç—Ä–æ–Ω—É—Ç–æ–≥–æ –∑–∞–∫–∞–∑–∞ (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)
details            - JSON —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–µ—Ç–∞–ª—è–º–∏
ip_address         - IP –∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞
created_at         - –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
updated_at         - –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```

## üîç –¢–∏–ø—ã –¥–µ–π—Å—Ç–≤–∏–π

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `user_login` - –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
- `user_logout` - –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
- `user_login_error` - –ù–µ—É–¥–∞—á–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞

### –ó–∞–∫–∞–∑—ã
- `order_create` - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
- `order_confirm` - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
- `order_complete` - –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
- `order_cancel` - –û—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–∞

### –°—Ç–æ–ª—ã
- `table_assign` - –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–∞ –∑–∞ –æ—Ñ–∏—Ü–∏–∞–Ω—Ç–æ–º
- `table_release` - –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Å—Ç–æ–ª–∞
- `table_status_check` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å—Ç–æ–ª–∞

### –ú–µ–Ω—é
- `menu_item_create` - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª—é–¥–∞
- `menu_item_update` - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–ª—é–¥–∞
- `menu_item_delete` - –£–¥–∞–ª–µ–Ω–∏–µ –±–ª—é–¥–∞



### –ü–µ—á–∞—Ç—å
- `print_kitchen_order` - –ü–µ—á–∞—Ç—å –∑–∞–∫–∞–∑–∞ –Ω–∞ –∫—É—Ö–Ω—é
- `print_bar_order` - –ü–µ—á–∞—Ç—å –∑–∞–∫–∞–∑–∞ –≤ –±–∞—Ä
- `print_receipt` - –ü–µ—á–∞—Ç—å —á–µ–∫–∞ –∫–ª–∏–µ–Ω—Ç—É

## üñ•Ô∏è CLI –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 –∑–∞–ø–∏—Å–µ–π –∑–∞ 24 —á–∞—Å–∞
flask audit logs

# –§–∏–ª—å—Ç—Ä –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É
flask audit logs --staff-id 1 --limit 20

# –§–∏–ª—å—Ç—Ä –ø–æ –¥–µ–π—Å—Ç–≤–∏—é
flask audit logs --action "order_create" --hours 48

# –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—à–∏–±–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
flask audit errors --hours 1

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –Ω–µ–¥–µ–ª—é
flask audit stats --days 7
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É

```bash
# –î–µ–π—Å—Ç–≤–∏—è –ø–æ —Å—Ç–æ–ª—É
flask audit by-table --table-id 5 --limit 30

# –î–µ–π—Å—Ç–≤–∏—è –ø–æ –∑–∞–∫–∞–∑—É
flask audit by-order --order-id 123 --limit 20

# –î–µ–π—Å—Ç–≤–∏—è —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ IP
flask audit by-ip --ip 192.168.1.100

# –õ–æ–≥–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥
flask audit date-range --from 2025-01-01 --to 2025-01-31

# –ü—Ä–æ—Å—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø–∏—Å–∏
flask audit recent --limit 100
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```bash
# –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤ (90+ –¥–Ω–µ–π)
flask audit cleanup --days 90

# –¢–µ—Å—Ç–æ–≤–∞—è –∑–∞–ø–∏—Å—å
flask audit test
```

## üåê API Endpoints

### –û—Å–Ω–æ–≤–Ω—ã–µ endpoints

```http
GET /api/audit/logs
  - –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–≥–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: page, per_page, staff_id, action, table_id, order_id, date_from, date_to

GET /api/audit/logs/recent
  - –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: limit (–¥–æ 100)

GET /api/audit/logs/staff/{staff_id}
  - –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: limit

GET /api/audit/logs/table/{table_id}
  - –õ–æ–≥–∏ –ø–æ —Å—Ç–æ–ª—É
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: limit

GET /api/audit/logs/order/{order_id}
  - –õ–æ–≥–∏ –ø–æ –∑–∞–∫–∞–∑—É
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: limit

GET /api/audit/logs/date-range
  - –õ–æ–≥–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: date_from, date_to, limit

GET /api/audit/statistics
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞—É–¥–∏—Ç–∞
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: days
```

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

```javascript
// –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–≥–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
fetch('/api/audit/logs?staff_id=1&action=order_create&limit=20')

// –õ–æ–≥–∏ –ø–æ —Å—Ç–æ–ª—É
fetch('/api/audit/logs/table/5?limit=30')

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –Ω–µ–¥–µ–ª—é
fetch('/api/audit/statistics?days=7')
```

## üîß –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞—Ö

```python
from app.utils.decorators import audit_action

@audit_action("order_create", table_affected=True, order_affected=True)
def create_order():
    # –î–µ–π—Å—Ç–≤–∏–µ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–æ
    pass
```

### –ü—Ä—è–º–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
from app.models import AuditLog

# –ü—Ä–æ—Å—Ç–∞—è –∑–∞–ø–∏—Å—å
AuditLog.log_action(
    action="custom_action",
    staff_id=user.id,
    details={"custom_data": "value"}
)

# –° –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
AuditLog.log_action(
    action="table_cleaned", 
    staff_id=waiter.id,
    table_affected=table_id,
    details={
        "cleaning_time": datetime.utcnow().isoformat(),
        "notes": "Deep cleaning completed"
    }
)
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```python
# –õ–æ–≥–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
logs = AuditLog.get_by_staff(staff_id=1, limit=50)

# –õ–æ–≥–∏ –ø–æ —Å—Ç–æ–ª—É
table_logs = AuditLog.get_by_table(table_id=5, limit=30)

# –õ–æ–≥–∏ –ø–æ –∑–∞–∫–∞–∑—É
order_logs = AuditLog.get_by_order(order_id=123, limit=20)

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏
recent = AuditLog.get_recent_logs_simple(limit=100)

# –õ–æ–≥–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥
from datetime import datetime, timedelta
start = datetime.utcnow() - timedelta(days=7)
end = datetime.utcnow()
period_logs = AuditLog.get_logs_by_date_range(start, end)

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
stats = AuditLog.get_statistics(days=7)
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏–∑

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π** –∑–∞ –ø–µ—Ä–∏–æ–¥
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫** –∏ –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
- **–¢–æ–ø –¥–µ–π—Å—Ç–≤–∏–π** - —Å–∞–º—ã–µ —á–∞—Å—Ç—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–¢–æ–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** - —Å–∞–º—ã–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏
- **–°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** –ø–æ —á–∞—Å–∞–º/–¥–Ω—è–º

### –ê–ª–µ—Ä—Ç—ã
–°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–∏:
- –í—ã—Å–æ–∫–æ–º –ø—Ä–æ—Ü–µ–Ω—Ç–µ –æ—à–∏–±–æ–∫ (>5%)
- –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å –æ–¥–Ω–æ–≥–æ IP
- –ß–∞—Å—Ç—ã—Ö –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö –≤—Ö–æ–¥–∞
- –ù–µ–æ–±—ã—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö –≤ –Ω–µ—Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- –ü–∞—Ä–æ–ª–∏ –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ `[FILTERED]`
- –¢–æ–∫–µ–Ω—ã –¥–æ—Å—Ç—É–ø–∞ —Å–∫—Ä—ã–≤–∞—é—Ç—Å—è
- –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

### –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- **–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤** - —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã
- **CLI –∫–æ–º–∞–Ω–¥—ã** - —Ç–æ–ª—å–∫–æ —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- **API –¥–æ—Å—Ç—É–ø** - —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ —Ä–æ–ª–∏ admin

### –°–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- –õ–æ–≥–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- –†–µ–≥—É–ª—è—Ä–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π

## üöÄ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã** `@audit_action` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
2. **–õ–æ–≥–∏—Ä—É–π—Ç–µ –≤–∞–∂–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ —è–≤–ª—è—é—Ç—Å—è HTTP –∑–∞–ø—Ä–æ—Å–∞–º–∏
3. **–î–æ–±–∞–≤–ª—è–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç** - —É–∫–∞–∑—ã–≤–∞–π—Ç–µ table_id –∏ order_id –≥–¥–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ
4. **–ù–µ –ª–æ–≥–∏—Ä—É–π—Ç–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –Ω–∞–ø—Ä—è–º—É—é

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
1. **–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –æ—à–∏–±–∫–∏** —Å –ø–æ–º–æ—â—å—é `flask audit errors`
2. **–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É** –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É** —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤
4. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**

### –î–ª—è –ø–æ–∏—Å–∫–∞ –ø—Ä–æ–±–ª–µ–º
1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –Ω—É–∂–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
2. **–ù–∞—á–∏–Ω–∞–π—Ç–µ —Å –æ–±—â–µ–≥–æ** (`flask audit logs`) –∏ —Å—É–∂–∞–π—Ç–µ –ø–æ–∏—Å–∫
3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –∑–∞–∫–∞–∑–æ–≤** –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –ø–µ—á–∞—Ç—å—é
4. **–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã** –æ—à–∏–±–æ–∫

## üìù –ü—Ä–∏–º–µ—Ä –∞–Ω–∞–ª–∏–∑–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞

```bash
# 1. –û–±—â–∏–π –æ–±–∑–æ—Ä –æ—à–∏–±–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 —á–∞—Å–∞
flask audit errors --hours 2

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
flask audit logs --staff-id 3 --hours 2

# 3. –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —Å—Ç–æ–ª–æ–º
flask audit by-table --table-id 8 --limit 50

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–∫–∞–∑–∞, —Å –∫–æ—Ç–æ—Ä—ã–º –±—ã–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã
flask audit by-order --order-id 456

# 5. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
flask audit stats --days 1
```

–≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –∏ —Ä–µ—à–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã. 

## üéâ –†–µ–∑—é–º–µ: –°–∏—Å—Ç–µ–º–∞ –∞—É–¥–∏—Ç–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞!

–í—ã –ø—Ä–∞–≤—ã –±—ã–ª–∏ - —è —Å–ª—É—á–∞–π–Ω–æ —É–¥–∞–ª–∏–ª –≤–∞–∂–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ø—Ä–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ. –¢–µ–ø–µ—Ä—å –≤—Å–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∏ –¥–∞–∂–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–æ:

### ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–æ:

1. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –º–µ—Ç–æ–¥—ã AuditLog:**
   - `get_by_table(table_id, limit)` - –ª–æ–≥–∏ –ø–æ —Å—Ç–æ–ª—É
   - `get_by_order(order_id, limit)` - –ª–æ–≥–∏ –ø–æ –∑–∞–∫–∞–∑—É  
   - `get_recent_logs_simple(limit)` - –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏
   - `get_logs_by_date_range(start, end)` - –ª–æ–≥–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥

2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞:**
   - –ü–µ—Ä–µ–Ω–µ—Å `admin_required` –≤ `utils/decorators.py`
   - –¢–µ–ø–µ—Ä—å –≤—Å–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω—ã

3. **–°–æ–∑–¥–∞–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:**
   - **AuditMiddleware** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
   - **CLI –∫–æ–º–∞–Ω–¥—ã** - —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤
   - **API endpoints** - –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∞—É–¥–∏—Ç—É
   - **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π, –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞

4. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
   - –ü–æ–∏—Å–∫ –ø–æ IP –∞–¥—Ä–µ—Å–∞–º
   - –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤
   - –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:

```bash
<code_block_to_apply_changes_from>
```

### üåê API endpoints:
- `GET /api/audit/logs` - —Å –ø–æ–ª–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- `GET /api/audit/logs/table/{id}` - –ø–æ —Å—Ç–æ–ª—É  
- `GET /api/audit/logs/order/{id}` - –ø–æ –∑–∞–∫–∞–∑—É
- `GET /api/audit/logs/date-range` - –∑–∞ –ø–µ—Ä–∏–æ–¥
- `GET /api/audit/statistics` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –∞—É–¥–∏—Ç–∞ –ª–æ–≥–∏—Ä—É–µ—Ç –í–°–ï –¥–µ–π—Å—Ç–≤–∏—è –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–æ—â–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞!** üöÄ 