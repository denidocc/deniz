<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}DENIZ Restaurant{% endblock %}</title>
    
    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='assets/images/logo.svg') }}">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/client/variables.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/client/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/client/components.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/client/modals.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/client/carousel.css') }}">
    {% block extra_css %}{% endblock %}
    
    <!-- Meta –¥–ª—è –ø–ª–∞–Ω—à–µ—Ç–æ–≤ -->
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="mobile-web-app-capable" content="yes">
</head>
<body class="tablet-layout" data-theme="light">
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div class="app-container">
        
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <div class="logo">
                    <img src="{{ url_for('static', filename='assets/images/logo.svg') }}" alt="DENIZ" class="logo-image">
                </div>
            </div>
            
            <div class="header-center">
                <div class="search-container">
                    <input type="text" 
                           class="search-input" 
                           placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞"
                           id="dishSearch">
                    <button class="search-btn" type="button">
                        <img src="{{ url_for('static', filename='assets/images/search.svg') }}" alt="–ü–æ–∏—Å–∫" class="search-icon">
                    </button>
                </div>
            </div>
            
            <div class="header-right">
                <button class="theme-toggle" id="themeToggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                    <img src="{{ url_for('static', filename='assets/images/moon.svg') }}" alt="–¢–µ–º–Ω–∞—è —Ç–µ–º–∞" class="theme-icon moon">
                    <img src="{{ url_for('static', filename='assets/images/sun.svg') }}" alt="–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞" class="theme-icon sun" style="display: none;">
                </button>
                
                <div class="language-selector">
                    <button class="lang-btn" data-lang="tm">TM</button>
                    <button class="lang-btn active" data-lang="ru">–†–£</button>
                    <button class="lang-btn" data-lang="en">EN</button>
                </div>
            </div>
        </header>
        
        <!-- Main Content -->
        <main class="app-main">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="categories-menu" id="categoriesMenu">
                    <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </aside>
            
            <!-- Content Area -->
            <section class="content-area">
                <!-- Promo Carousel -->
                <div class="promo-carousel" id="promoCarousel">
                    <!-- –ö–∞—Ä—É—Å–µ–ª—å –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                
                {% block content %}{% endblock %}
            </section>
            
            <!-- Cart Sidebar -->
            <aside class="cart-sidebar">
                <div class="cart-header">
                    <h3 class="cart-title">–ö–æ—Ä–∑–∏–Ω–∞</h3>
                    <div class="table-selector">
                        <button class="table-select-btn" id="tableSelectBtn">
                            <span class="table-text">–°—Ç–æ–ª #<span id="currentTableNumber">10</span></span>
                            <svg class="dropdown-icon" viewBox="0 0 24 24">
                                <path d="M7,10L12,15L17,10H7Z"/>
                            </svg>
                        </button>
                    </div>
                    <button class="clear-cart-btn" id="clearCartBtn">–û—á–∏—Å—Ç–∏—Ç—å</button>
                </div>
                
                <div class="cart-content" id="cartContent">
                    <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ—Ä–∑–∏–Ω—ã -->
                    <div class="empty-cart">
                        <div class="empty-cart-illustration">
                            <img src="{{ url_for('static', filename='assets/images/fish.png') }}" alt="–†—ã–±–∞" class="fish-image">
                        </div>
                        <p class="empty-cart-text">
                            –ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞, –Ω–æ –º–æ—Ä–µ –ø–æ–ª–Ω–æ–µ.<br>
                            –ó–∞–≥–ª—è–Ω–∏—Ç–µ –≤ –º–µ–Ω—é ‚Äî —Ç–∞–º –≤–æ–ª–Ω—ã –≤–∫—É—Å–∞.
                        </p>
                    </div>
                    
                    <!-- Rudder pattern -->
                    <div class="rudder-pattern">
                        <!-- SVG –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ assets/rudder.svg -->
                    </div>
                </div>
                
                <div class="cart-footer" id="cartFooter" style="display: none;">
                    <div class="cart-actions">
                        <button class="btn btn-secondary" id="bonusCardBtn">
                            üéÅ –ë–æ–Ω—É—Å–Ω–∞—è –∫–∞—Ä—Ç–∞
                        </button>
                        <button class="btn btn-primary" id="placeOrderBtn">
                            –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
                        </button>
                    </div>
                </div>
            </aside>
        </main>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div class="modal-overlay" id="modalOverlay"></div>
    
    <!-- JavaScript -->
    <script src="{{ url_for('static', filename='js/client/utils.js') }}"></script>
    <script src="{{ url_for('static', filename='js/client/api.js') }}"></script>
    <script src="{{ url_for('static', filename='js/client/language.js') }}"></script>
    <script src="{{ url_for('static', filename='js/client/theme.js') }}"></script>
    <script src="{{ url_for('static', filename='js/client/cart.js') }}"></script>
    <script src="{{ url_for('static', filename='js/client/search.js') }}"></script>
    <script src="{{ url_for('static', filename='js/client/modals.js') }}"></script>
    <script src="{{ url_for('static', filename='js/client/carousel.js') }}"></script>
    {% block extra_js %}{% endblock %}
    
    <!-- Initialize App -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
            ModalManager.init();
            CartManager.init();
            MenuManager.init();
            CarouselManager.init();
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            document.getElementById('tableSelectBtn').addEventListener('click', function() {
                ModalManager.openTableWithPin(CartManager.getCurrentTableId());
            });
            
            document.getElementById('bonusCardBtn').addEventListener('click', function() {
                ModalManager.openBonusCard(function(bonusData) {
                    CartManager.applyBonusCard(bonusData);
                });
            });
            
            document.getElementById('placeOrderBtn').addEventListener('click', function() {
                CartManager.placeOrder();
            });
            
            // –ö–Ω–æ–ø–∫–∞ "–ü–æ–∑–≤–∞—Ç—å –æ—Ñ–∏—Ü–∏–∞–Ω—Ç–∞"
            document.addEventListener('click', function(e) {
                if (e.target.matches('.call-waiter-btn')) {
                    const tableId = CartManager.getCurrentTableId();
                    if (tableId) {
                        ClientAPI.callWaiter(tableId).then(response => {
                            if (response.status === 'success') {
                                Utils.showToast('–û—Ñ–∏—Ü–∏–∞–Ω—Ç –≤—ã–∑–≤–∞–Ω!', 'success');
                            } else {
                                Utils.showToast('–û—à–∏–±–∫–∞ –≤—ã–∑–æ–≤–∞ –æ—Ñ–∏—Ü–∏–∞–Ω—Ç–∞', 'error');
                            }
                        }).catch(error => {
                            Utils.showToast('–û—à–∏–±–∫–∞ –≤—ã–∑–æ–≤–∞ –æ—Ñ–∏—Ü–∏–∞–Ω—Ç–∞', 'error');
                        });
                    } else {
                        Utils.showToast('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–æ–ª', 'warning');
                    }
                }
            });
        });
    </script>
</body>
</html>